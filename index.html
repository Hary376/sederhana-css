let screen = document.getElementById("screen");
let history = document.getElementById("history");
let memory = 0;

function insert(val) {
  screen.value += val;
}

function clearAll() {
  screen.value = "";
}

function back() {
  screen.value = screen.value.slice(0, -1);
}

// Fungsi pembantu untuk mengubah derajat ke radian jika mode "Deg" terpilih
function toRad(angle) {
  const isDeg = document.getElementsByName("mode")[0].checked;
  return isDeg ? angle * (Math.PI / 180) : angle;
}

function calculate() {
  try {
    let exp = screen.value
      .replace(/Ï€/g, "Math.PI")
      .replace(/e/g, "Math.E")
      .replace(/\^/g, "**")
      // Mengarahkan sin, cos, tan ke fungsi Math dan menangani konversi derajat
      .replace(/sin\(([^)]+)\)/g, "Math.sin(toRad($1))")
      .replace(/cos\(([^)]+)\)/g, "Math.cos(toRad($1))")
      .replace(/tan\(([^)]+)\)/g, "Math.tan(toRad($1))");

    let res = eval(exp);
    
    // Membatasi desimal agar tidak terlalu panjang
    if (!Number.isInteger(res)) res = parseFloat(res.toFixed(8));

    history.innerHTML += `<div>${screen.value} = ${res}</div>`;
    screen.value = res;
  } catch (e) {
    screen.value = "Error";
  }
}

function func(f) {
  screen.value += f;
}

function fact(n) {
  if (n < 0) return NaN;
  if (n === 0) return 1;
  let result = 1;
  for (let i = 2; i <= n; i++) result *= i;
  return result;
}

function memoryAdd() { memory += Number(eval(screen.value) || 0); }
function memorySub() { memory -= Number(eval(screen.value) || 0); }
function memoryRecall() { screen.value += memory; }
